{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\GIGABYTE\\\\Desktop\\\\dpma\\\\frontend\\\\src\\\\components\\\\users\\\\profile\\\\profile-board.jsx\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Clock, Place, Camera, User, Birth, Home_3 as Home } from \"../../../assets/icons/icons\";\nimport Loading from \"../../../shared/loading.js\";\nimport LoadingPage from \"../../../shared/models/loading-modal\";\nimport ErrorModal from \"../../../shared/models/error-model\";\nimport { useFetch } from \"../../../shared/hooks/useFetch\";\nimport Cropper from \"react-cropper\";\nimport \"cropperjs/dist/cropper.css\";\nconst ProfileBoard = React.memo(({\n  user,\n  isProfile,\n  img,\n  setImg\n}) => {\n  const {\n    loading,\n    request,\n    error,\n    clearError\n  } = useFetch();\n  const filePickerRef = useRef();\n  const CropperRef = useRef(0);\n  const [crop, setCrop] = useState(false);\n  const [files, setFiles] = useState();\n\n  const pickedHandler = event => {\n    let pickedFile;\n\n    if (event.target.files && event.target.files.length === 1) {\n      pickedFile = event.target.files[0];\n      setFiles(pickedFile);\n    }\n  };\n\n  const previewImg = async () => {\n    const fileReader = new FileReader();\n\n    fileReader.onload = () => {\n      setCrop(fileReader.result);\n    };\n\n    fileReader.readAsDataURL(files);\n  };\n\n  const changeImg = async imgData => {\n    const dataset = JSON.parse(localStorage.getItem(\"userData2\"));\n    const payload = new FormData();\n    payload.append(\"x\", imgData.x);\n    payload.append(\"y\", imgData.y);\n    payload.append(\"width\", imgData.width);\n    payload.append(\"height\", imgData.height);\n    payload.append(\"img\", files);\n\n    try {\n      const respond = await request(process.env.REACT_APP_BACKEND_URL + `/users/img/${user._id}`, \"post\", payload, {\n        Authorization: \"Bearer \" + user.token\n      });\n      setImg(respond.data.img);\n      localStorage.setItem(\"userData2\", JSON.stringify({ ...dataset,\n        img: respond.data.img\n      }));\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  useEffect(() => {\n    if (!files) {\n      return;\n    }\n\n    previewImg(); // changeImg();\n  }, [files]);\n\n  const pickImageHandler = () => {\n    filePickerRef.current.click();\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, loading && React.createElement(LoadingPage, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }), crop && React.createElement(\"div\", {\n    className: \"modal__container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"modal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"modal__body cropper\",\n    onClick: e => e.stopPropagation(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, React.createElement(Cropper, {\n    ref: CropperRef,\n    src: crop,\n    style: {\n      height: \"80vh\",\n      width: \"100%\"\n    } // Cropper.js options\n    ,\n    zoomable: false,\n    aspectRatio: 1,\n    viewMode: 2,\n    responsive: true,\n    guides: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"modal__footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"btn btn--outlined-danger\",\n    onClick: () => setCrop(false),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \"Cancel\"), React.createElement(\"button\", {\n    className: \"btn btn--contained-success\",\n    onClick: () => {\n      setCrop(null);\n      changeImg(CropperRef.current.cropper.getData());\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, \"Submit\"))))), error && React.createElement(ErrorModal, {\n    message: \"there was a problem with the image!\",\n    closeModal: clearError,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"profile__cover\",\n    style: {\n      backgroundImage: `url(${user.cover ? user.cover : \"https://cdn.dribbble.com/users/648922/screenshots/9157929/media/e5d45686a9feeefaff2780443188a2d8.png\"})`\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"profile__row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, isProfile && React.createElement(\"input\", {\n    ref: filePickerRef,\n    style: {\n      display: \"none\"\n    },\n    type: \"file\",\n    accept: \".png,.jpg,.jpeg\",\n    onChange: pickedHandler,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"profile__info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__info__picture\",\n    title: \"Change your image\",\n    style: {\n      cursor: `${isProfile ? \"pointer\" : \"default\"}`\n    },\n    onClick: isProfile ? pickImageHandler : null,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: img || user.img,\n    alt: \"aa\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }), isProfile && React.createElement(\"div\", {\n    className: \"profile__info__picture--icon\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(Camera, {\n    fill: \"#fff\",\n    width: \"2rem\",\n    height: \"2rem\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }))), React.createElement(\"h2\", {\n    className: \"profile__info__username\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, user.username), React.createElement(\"h2\", {\n    className: \"profile__info__name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, user.name)), React.createElement(\"div\", {\n    className: \"profile__info__statics\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__info__statics--head\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, \"posts\"), React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"chat Friends\")), React.createElement(\"div\", {\n    className: \"seprator\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"profile__info__statics--result\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, user.posts.length), React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, user.chatRooms.length)), user.about && user.about.bio && React.createElement(\"p\", {\n    className: \"profile__info__bio\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, user.about.bio))), React.createElement(\"div\", {\n    className: \"profile__about\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, \"About\"), React.createElement(\"div\", {\n    className: \"seprator\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"profile__about__field\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__about__field__quest\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, React.createElement(Clock, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }), React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"Joined at \")), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, new Date(user.createdAt).toLocaleDateString())), user.about && user.about.livesIn && React.createElement(\"div\", {\n    className: \"profile__about__field\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__about__field__quest\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, React.createElement(Place, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }), React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, \"lives in\")), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, user.about.livesIn)), user.about && user.about.from && React.createElement(\"div\", {\n    className: \"profile__about__field\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__about__field__quest\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(Home, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }), React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, \"from\")), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, user.about.from)), user.about && user.about.birth && React.createElement(\"div\", {\n    className: \"profile__about__field\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__about__field__quest\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, React.createElement(Birth, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }), React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210\n    },\n    __self: this\n  }, \"was born on\")), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, user.about.birth)), user.about && user.about.gender && React.createElement(\"div\", {\n    className: \"profile__about__field\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"profile__about__field__quest\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, React.createElement(User, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }), React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, \"gender \")), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, user.about.gender))));\n});\nexport default ProfileBoard;","map":{"version":3,"sources":["C:/Users/GIGABYTE/Desktop/dpma/frontend/src/components/users/profile/profile-board.jsx"],"names":["React","useState","useEffect","useRef","Clock","Place","Camera","User","Birth","Home_3","Home","Loading","LoadingPage","ErrorModal","useFetch","Cropper","ProfileBoard","memo","user","isProfile","img","setImg","loading","request","error","clearError","filePickerRef","CropperRef","crop","setCrop","files","setFiles","pickedHandler","event","pickedFile","target","length","previewImg","fileReader","FileReader","onload","result","readAsDataURL","changeImg","imgData","dataset","JSON","parse","localStorage","getItem","payload","FormData","append","x","y","width","height","respond","process","env","REACT_APP_BACKEND_URL","_id","Authorization","token","data","setItem","stringify","err","console","log","pickImageHandler","current","click","e","stopPropagation","cropper","getData","backgroundImage","cover","display","cursor","username","name","posts","chatRooms","about","bio","Date","createdAt","toLocaleDateString","livesIn","from","birth","gender"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n  Clock,\r\n  Place,\r\n  Camera,\r\n  User,\r\n  Birth,\r\n  Home_3 as Home,\r\n} from \"../../../assets/icons/icons\";\r\nimport Loading from \"../../../shared/loading.js\";\r\nimport LoadingPage from \"../../../shared/models/loading-modal\";\r\nimport ErrorModal from \"../../../shared/models/error-model\";\r\nimport { useFetch } from \"../../../shared/hooks/useFetch\";\r\nimport Cropper from \"react-cropper\";\r\nimport \"cropperjs/dist/cropper.css\";\r\n\r\nconst ProfileBoard = React.memo(({ user, isProfile, img, setImg }) => {\r\n  const { loading, request, error, clearError } = useFetch();\r\n  const filePickerRef = useRef();\r\n  const CropperRef = useRef(0);\r\n  const [crop, setCrop] = useState(false);\r\n  const [files, setFiles] = useState();\r\n\r\n  const pickedHandler = (event) => {\r\n    let pickedFile;\r\n    if (event.target.files && event.target.files.length === 1) {\r\n      pickedFile = event.target.files[0];\r\n      setFiles(pickedFile);\r\n    }\r\n  };\r\n  const previewImg = async () => {\r\n    const fileReader = new FileReader();\r\n    fileReader.onload = () => {\r\n      setCrop(fileReader.result);\r\n    };\r\n    fileReader.readAsDataURL(files);\r\n  };\r\n  const changeImg = async (imgData) => {\r\n    const dataset = JSON.parse(localStorage.getItem(\"userData2\"));\r\n    const payload = new FormData();\r\n    payload.append(\"x\", imgData.x);\r\n    payload.append(\"y\", imgData.y);\r\n    payload.append(\"width\", imgData.width);\r\n    payload.append(\"height\", imgData.height);\r\n    payload.append(\"img\", files);\r\n    try {\r\n      const respond = await request(\r\n        process.env.REACT_APP_BACKEND_URL + `/users/img/${user._id}`,\r\n        \"post\",\r\n        payload,\r\n        {\r\n          Authorization: \"Bearer \" + user.token,\r\n        }\r\n      );\r\n      setImg(respond.data.img);\r\n      localStorage.setItem(\r\n        \"userData2\",\r\n        JSON.stringify({\r\n          ...dataset,\r\n          img: respond.data.img,\r\n        })\r\n      );\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    if (!files) {\r\n      return;\r\n    }\r\n    previewImg();\r\n    // changeImg();\r\n  }, [files]);\r\n\r\n  const pickImageHandler = () => {\r\n    filePickerRef.current.click();\r\n  };\r\n  return (\r\n    <div>\r\n      {loading && <LoadingPage />}\r\n      {crop && (\r\n        <div className=\"modal__container\">\r\n          <div className=\"modal\">\r\n            <div\r\n              className=\"modal__body cropper\"\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <Cropper\r\n                ref={CropperRef}\r\n                src={crop}\r\n                style={{ height: \"80vh\", width: \"100%\" }}\r\n                // Cropper.js options\r\n                zoomable={false}\r\n                aspectRatio={1}\r\n                viewMode={2}\r\n                responsive={true}\r\n                guides={false}\r\n              />\r\n              <div className=\"modal__footer\">\r\n                <button\r\n                  className=\"btn btn--outlined-danger\"\r\n                  onClick={() => setCrop(false)}\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  className=\"btn btn--contained-success\"\r\n                  onClick={() => {\r\n                    setCrop(null);\r\n                    changeImg(CropperRef.current.cropper.getData());\r\n                  }}\r\n                >\r\n                  Submit\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {error && (\r\n        <ErrorModal\r\n          message=\"there was a problem with the image!\"\r\n          closeModal={clearError}\r\n        />\r\n      )}\r\n      <div\r\n        className=\"profile__cover\"\r\n        style={{\r\n          backgroundImage: `url(${\r\n            user.cover\r\n              ? user.cover\r\n              : \"https://cdn.dribbble.com/users/648922/screenshots/9157929/media/e5d45686a9feeefaff2780443188a2d8.png\"\r\n          })`,\r\n        }}\r\n      ></div>\r\n      <div className=\"profile__row\">\r\n        {isProfile && (\r\n          <input\r\n            ref={filePickerRef}\r\n            style={{ display: \"none\" }}\r\n            type=\"file\"\r\n            accept=\".png,.jpg,.jpeg\"\r\n            onChange={pickedHandler}\r\n          />\r\n        )}\r\n        <div className=\"profile__info\">\r\n          <div\r\n            className=\"profile__info__picture\"\r\n            title=\"Change your image\"\r\n            style={{ cursor: `${isProfile ? \"pointer\" : \"default\"}` }}\r\n            onClick={isProfile ? pickImageHandler : null}\r\n          >\r\n            <img src={img || user.img} alt=\"aa\" />\r\n            {isProfile && (\r\n              <div className=\"profile__info__picture--icon\">\r\n                <Camera fill=\"#fff\" width=\"2rem\" height=\"2rem\" />\r\n              </div>\r\n            )}\r\n          </div>\r\n          <h2 className=\"profile__info__username\">{user.username}</h2>\r\n          <h2 className=\"profile__info__name\">{user.name}</h2>\r\n        </div>\r\n        <div className=\"profile__info__statics\">\r\n          <div className=\"profile__info__statics--head\">\r\n            <h3>posts</h3>\r\n            <h3>chat Friends</h3>\r\n          </div>\r\n          <div className=\"seprator\" />\r\n          <div className=\"profile__info__statics--result\">\r\n            <h3>{user.posts.length}</h3>\r\n            <h3>{user.chatRooms.length}</h3>\r\n          </div>\r\n          {user.about && user.about.bio && (\r\n            <p className=\"profile__info__bio\">{user.about.bio}</p>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"profile__about\">\r\n        <h2>About</h2>\r\n        <div className=\"seprator\" />\r\n        <div className=\"profile__about__field\">\r\n          <div className=\"profile__about__field__quest\">\r\n            <Clock />\r\n            <h4>Joined at </h4>\r\n          </div>\r\n          <p>{new Date(user.createdAt).toLocaleDateString()}</p>\r\n        </div>\r\n        {user.about && user.about.livesIn && (\r\n          <div className=\"profile__about__field\">\r\n            <div className=\"profile__about__field__quest\">\r\n              <Place />\r\n              <h4>lives in</h4>\r\n            </div>\r\n            <p>{user.about.livesIn}</p>\r\n          </div>\r\n        )}\r\n        {user.about && user.about.from && (\r\n          <div className=\"profile__about__field\">\r\n            <div className=\"profile__about__field__quest\">\r\n              <Home />\r\n              <h4>from</h4>\r\n            </div>\r\n            <p>{user.about.from}</p>\r\n          </div>\r\n        )}\r\n        {user.about && user.about.birth && (\r\n          <div className=\"profile__about__field\">\r\n            <div className=\"profile__about__field__quest\">\r\n              <Birth />\r\n              <h4>was born on</h4>\r\n            </div>\r\n            <p>{user.about.birth}</p>\r\n          </div>\r\n        )}\r\n        {user.about && user.about.gender && (\r\n          <div className=\"profile__about__field\">\r\n            <div className=\"profile__about__field__quest\">\r\n              <User />\r\n              <h4>gender </h4>\r\n            </div>\r\n\r\n            <p>{user.about.gender}</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\nexport default ProfileBoard;\r\n"]},"metadata":{},"sourceType":"module"}