{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\GIGABYTE\\\\Desktop\\\\dpma\\\\frontend\\\\src\\\\components\\\\routes\\\\on.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Home from '../home';\nimport { Switch, Redirect, Route } from 'react-router-dom';\nimport Chat from '../chat/chat-page';\nimport Loading from '../../shared/models/loading-modal';\nimport { useFetch } from \"../../shared/hooks/useFetch\";\nimport socket from '../socket';\n\nconst On = () => {\n  const {\n    loading,\n    request\n  } = useFetch();\n  const user = useSelector(state => state.currentUser);\n  const dispatch = useDispatch();\n\n  const injectSocketIdToUser = async () => {\n    console.log(socket.id);\n\n    try {\n      const response = await request(process.env.REACT_APP_BACKEND_URL + `/users/update-info/${user._id}`, \"patch\", {\n        socketId: socket.id\n      }, {\n        Authorization: \"Bearer \" + user.token\n      });\n      dispatch({\n        type: 'ADD_SOCKET',\n        payload: socket.id\n      });\n    } catch (err) {\n      console.log(err.response);\n    }\n  };\n\n  useEffect(() => {\n    if (user && user._id) {\n      console.log('sent');\n      socket.emit('action', {\n        type: 'USER_LOGIN',\n        userId: user._id\n      });\n    }\n  }, [user]);\n\n  if (user && user.token) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46\n      },\n      __self: this\n    }, React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    }, React.createElement(Route, {\n      path: \"/chat\",\n      component: Chat,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/\",\n      component: Home,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }), React.createElement(Redirect, {\n      from: \"*\",\n      to: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }))));\n  }\n\n  return React.createElement(Loading, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  });\n};\n\nexport default On;","map":{"version":3,"sources":["C:/Users/GIGABYTE/Desktop/dpma/frontend/src/components/routes/on.js"],"names":["React","useEffect","useState","useSelector","useDispatch","Home","Switch","Redirect","Route","Chat","Loading","useFetch","socket","On","loading","request","user","state","currentUser","dispatch","injectSocketIdToUser","console","log","id","response","process","env","REACT_APP_BACKEND_URL","_id","socketId","Authorization","token","type","payload","err","emit","userId"],"mappings":";AAAA,OAAOA,KAAP,IAAcC,SAAd,EAAwBC,QAAxB,QAAuC,OAAvC;AACA,SAAQC,WAAR,EAAoBC,WAApB,QAAsC,aAAtC;AACA,OAAOC,IAAP,MAAiB,SAAjB;AACA,SAAQC,MAAR,EAAeC,QAAf,EAAwBC,KAAxB,QAAoC,kBAApC;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,OAAP,MAAoB,mCAApB;AACA,SAASC,QAAT,QAAyB,6BAAzB;AACA,OAAOC,MAAP,MAAmB,WAAnB;;AAEA,MAAMC,EAAE,GAAC,MAAI;AACZ,QAAM;AAAEC,IAAAA,OAAF;AAAYC,IAAAA;AAAZ,MAAwBJ,QAAQ,EAAtC;AACA,QAAMK,IAAI,GAAGb,WAAW,CAACc,KAAK,IAAEA,KAAK,CAACC,WAAd,CAAxB;AACG,QAAMC,QAAQ,GAAEf,WAAW,EAA3B;;AACA,QAAMgB,oBAAoB,GAAE,YAAU;AAC9BC,IAAAA,OAAO,CAACC,GAAR,CAAYV,MAAM,CAACW,EAAnB;;AAER,QAAI;AACF,YAAMC,QAAQ,GAAG,MAAMT,OAAO,CAC5BU,OAAO,CAACC,GAAR,CAAYC,qBAAZ,GACG,sBAAqBX,IAAI,CAACY,GAAI,EAFL,EAG5B,OAH4B,EAI5B;AAACC,QAAAA,QAAQ,EAACjB,MAAM,CAACW;AAAjB,OAJ4B,EAK5B;AACEO,QAAAA,aAAa,EAAE,YAAYd,IAAI,CAACe;AADlC,OAL4B,CAA9B;AASAZ,MAAAA,QAAQ,CAAC;AACRa,QAAAA,IAAI,EAAC,YADG;AAERC,QAAAA,OAAO,EAACrB,MAAM,CAACW;AAFP,OAAD,CAAR;AAID,KAdD,CAcE,OAAOW,GAAP,EAAY;AACZb,MAAAA,OAAO,CAACC,GAAR,CAAYY,GAAG,CAACV,QAAhB;AACD;AACF,GApBC;;AAqBFvB,EAAAA,SAAS,CAAC,MAAI;AAEX,QAAGe,IAAI,IAAIA,IAAI,CAACY,GAAhB,EAAoB;AACnBP,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACAV,MAAAA,MAAM,CAACuB,IAAP,CAAY,QAAZ,EAAqB;AACnBH,QAAAA,IAAI,EAAC,YADc;AAEnBI,QAAAA,MAAM,EAACpB,IAAI,CAACY;AAFO,OAArB;AAGA;AACH,GARQ,EAQP,CAACZ,IAAD,CARO,CAAT;;AASE,MAAGA,IAAI,IAAIA,IAAI,CAACe,KAAhB,EAAsB;AACzB,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACN;AAAM,MAAA,SAAS,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACC,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,OAAZ;AAAoB,MAAA,SAAS,EAAEtB,IAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,EAEC,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,GAAZ;AAAgB,MAAA,SAAS,EAAEJ,IAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFD,EAGC,oBAAC,QAAD;AAAU,MAAA,IAAI,EAAC,GAAf;AAAmB,MAAA,EAAE,EAAC,EAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHD,CADA,CADM,CAAP;AASC;;AACD,SAAO,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACA,CA9CD;;AA+CA,eAAeQ,EAAf","sourcesContent":["import React,{useEffect,useState} from 'react';\r\nimport {useSelector,useDispatch} from 'react-redux'\r\nimport Home from '../home';\r\nimport {Switch,Redirect,Route} from 'react-router-dom';\r\nimport Chat from '../chat/chat-page';\r\nimport Loading from '../../shared/models/loading-modal';\r\nimport { useFetch } from \"../../shared/hooks/useFetch\";\r\nimport socket from '../socket'\r\n\r\nconst On=()=>{\r\n\tconst { loading , request } = useFetch();\r\n\tconst user = useSelector(state=>state.currentUser);\r\n    const dispatch= useDispatch();\r\n    const injectSocketIdToUser= async ()=>{\r\n            console.log(socket.id);\r\n\r\n    try {\r\n      const response = await request(\r\n        process.env.REACT_APP_BACKEND_URL +\r\n          `/users/update-info/${user._id}`,\r\n        \"patch\",\r\n        {socketId:socket.id},\r\n        {\r\n          Authorization: \"Bearer \" + user.token,\r\n        }\r\n      );\r\n      dispatch({\r\n      \ttype:'ADD_SOCKET',\r\n      \tpayload:socket.id\r\n      }) \r\n    } catch (err) {\r\n      console.log(err.response);\r\n    }\r\n  }\r\n  useEffect(()=>{\r\n  \r\n     if(user && user._id){\r\n      console.log('sent')\r\n      socket.emit('action',{\r\n        type:'USER_LOGIN',\r\n        userId:user._id})\r\n     }\r\n  },[user])\r\n    if(user && user.token){\r\n\treturn <div>\t\t  \r\n\t\t<div  className=\"wrapper\">\r\n\t\t<Switch>\r\n\t\t\t<Route path=\"/chat\" component={Chat}/>\r\n\t\t\t<Route path=\"/\" component={Home} />\r\n\t\t\t<Redirect from=\"*\" to='' />\r\n\t\t</Switch>\t\t\r\n\t\t</div>\r\n\t\t</div>\r\n\t}\r\n\treturn <Loading />\r\n}\r\nexport default On;"]},"metadata":{},"sourceType":"module"}